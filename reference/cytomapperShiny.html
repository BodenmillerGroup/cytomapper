<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Shiny application to visualise gated cells on images — cytomapperShiny • cytomapper</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Shiny application to visualise gated cells on images — cytomapperShiny"><meta property="og:description" content="This shiny application allows users to gate cells based on their raw or
transformed expression values and visualises gated cells on their
corresponding images."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cytomapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/cytomapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cytomapper_ondisk.html">On disk storage and handling of images</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BodenmillerGroup/cytomapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Shiny application to visualise gated cells on images</h1>
    <small class="dont-index">Source: <a href="https://github.com/BodenmillerGroup/cytomapper/blob/HEAD/R/cytomapperShiny.R" class="external-link"><code>R/cytomapperShiny.R</code></a></small>
    <div class="hidden name"><code>cytomapperShiny.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This shiny application allows users to gate cells based on their raw or
transformed expression values and visualises gated cells on their
corresponding images.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cytomapperShiny</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  mask <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  image <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  img_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></code> object.</p></dd>


<dt>mask</dt>
<dd><p>(optional) a <code><a href="CytoImageList.html">CytoImageList</a></code> containing
single-channel <code><a href="https://rdrr.io/pkg/EBImage/man/Image.html" class="external-link">Image</a></code> objects.</p></dd>


<dt>image</dt>
<dd><p>(optional) a <code><a href="CytoImageList.html">CytoImageList</a></code> object containing
single or multi-channel <code><a href="https://rdrr.io/pkg/EBImage/man/Image.html" class="external-link">Image</a></code> objects.</p></dd>


<dt>cell_id</dt>
<dd><p>character specifying the <code>colData(object)</code> entry, in which
the integer cell IDs are stored. These IDs should match the integer pixel
values in the segmentation mask object (<code>mask</code>).</p></dd>


<dt>img_id</dt>
<dd><p>character specifying the <code>colData(object)</code> and
<code>mcols(mask)</code> and/or <code>mcols(image)</code> entry, 
in which the image IDs are stored.</p></dd>


<dt>...</dt>
<dd><p>parameters passed to the <code><a href="plotCells.html">plotCells</a></code> or
<code><a href="plotPixels.html">plotPixels</a></code> function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A Shiny app object for hierarchical gating of cells</p>
    </div>
    <div id="user-inputs">
    <h2>User inputs</h2>
    

<p>This function requires at least a <code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></code>
input object. Gating is performed on cell-specific marker counts stored in the
<code>assay</code> slots of the object. These can either be raw counts (usually
stored in the <code>counts</code> slot) or transformed/scaled counts stored in other
assay slots. Gating can only be performed sample-wise; therefore, even if
<code>mask</code> or <code>image</code> are not specified, <code>img_id</code> needs to point to
the <code>colData</code> entry storing unique sample IDs. Furthermore, the
<code>cell_id</code> entry is required to identify cells during hierarchical gating.</p>
<p>If mask is specified, marker expression values and selected cells will be
visualised by using the <code><a href="plotCells.html">plotCells</a></code> function. To visualise
pixel-level information with <code><a href="plotPixels.html">plotPixels</a></code>, the user has to
further provide multi-channel images stored in a <code>CytoImageList</code>.</p>
    </div>
    <div id="the-user-interface-ui-">
    <h2>The user interface (UI)</h2>
    

<p>The UI's body is composed of two tabs (<em>Scatter Plots</em> and
<em>Images</em>). The side bar contains the <em>General Control</em> and
<em>Plots</em> panels. Both panels can be collapsed; however only one can be
expanded again.. Using the control panel, the user can set the number of
plots, which sample to display and which <code>assay</code> slot to use for plotting
expression. The <em>Plots</em> panel can be used to select up to two markers per
plot. A one-marker selection is displayed as violin and jittered points, two
markers are shown as scatter plot. To define a subset of cells, the user can
draw gates on the plots. When using multiple plots, the gate applied in a plot
will define the subset of cells displayed in the next plot. The number of
plots, the marker selection and the applied gates will be transferred when
switching between samples. When switching markers or assay slots, the gates
will be removed.</p>
<p>By switching to the <code>Images</code> tab, the user can inspect marker expression
levels and the result of the gating. This requires either an entry to
<code>mask</code> and (optionally) <code>image</code>. Depending on the input, the left
image visualises the expression of the selected markers by using
<code><a href="plotCells.html">plotCells</a></code> (if <code>mask</code> is supplied) or
<code><a href="plotPixels.html">plotPixels</a></code> (if <code>image</code> is supplied). Displayed markers can
be changed using the dropdown menu. If <code>images</code> are provided, the user
can change the contrast of the selected markers. The right image colors
(<code>masks</code>) or outlines (<code>images</code>) gated cells. Both the left and the
right image come with a zoom-in functionality.</p>
<p>The header section of the shiny allows to hide the side bar, to download
selected cells (see below), or to display the <code>sessionInfo</code> output and
the <em>Help</em> section (see below).</p>
    </div>
    <div id="download-of-gated-cells">
    <h2>Download of gated cells</h2>
    

<p>The user can download the selected cells in form of a
<code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></code> object. The output is a subset of
the input <code>SingleCellExperiment</code> object. The downloaded object (in form
of a .rds file) contains a new <code>colData</code> entry containing the label of
the subset defined by the user (using the <em>Cell label</em> argument). The
cell label is stored in <code>colData(object)$cytomapper_CellLabel</code></p>
<p>The <code>metadata</code> slot of the <code><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></code>
object will be converted to a list. It contains the original metadata
(<code>metadata(object)$metadata</code>), gating parameters (e.g.
<code>metadata(object)$cytomapper_gate_1</code>), <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> output
(<code>metadata(object)$cytomapper_SessionInfo</code>), and the date
(<code>metadata(object)$cytomapper_GatingDate</code>).</p>
    </div>
    <div id="passing-further-parameters">
    <h2>Passing further parameters</h2>
    

<p>To customise the visual output of <code>cytomapperShiny</code>, refer to
<code><a href="plotting-param.html">plotting-param</a></code>. Further arguments can be passed to the
<code><a href="plotCells.html">plotCells</a></code> and <code><a href="plotPixels.html">plotPixels</a></code> function. As an example:
To avoid interpolation of output images, set <code>interpolate = FALSE</code>.
Passing the parameter <code>interpolate = FALSE</code> will make images less blurry,
which might be useful while using the zoom-in functionality of
<code>cytomapperShiny</code> .</p>
    </div>
    <div id="getting-further-help">
    <h2>Getting further help</h2>
    

<p>Please refer to the <em>Help</em> section found when clicking the '?' button in
the upper right corner. The <em>Help</em> section contains a recommended
workflow on how to use the app.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plotCells.html">plotCells</a></code> and <code><a href="plotPixels.html">plotPixels</a></code> for the main
plotting functions</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nils Eling (<a href="mailto:nils.eling@dqbm.uzh.ch">nils.eling@dqbm.uzh.ch</a>)</p>
<p>Tobias Hoch (<a href="mailto:tobias.hoch@dqbm.uzh.ch">tobias.hoch@dqbm.uzh.ch</a>)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Only run this example in interactive R sessions</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="co"># Load example data sets</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pancreasSCE"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pancreasImages"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pancreasMasks"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># Use shiny with SCE object, images and masks</span></span></span>
<span class="r-in"><span>   <span class="fu">cytomapperShiny</span><span class="op">(</span>object <span class="op">=</span> <span class="va">pancreasSCE</span>, mask <span class="op">=</span> <span class="va">pancreasMasks</span>, </span></span>
<span class="r-in"><span>                 image <span class="op">=</span> <span class="va">pancreasImages</span>, cell_id <span class="op">=</span> <span class="st">"CellNb"</span>, </span></span>
<span class="r-in"><span>                 img_id <span class="op">=</span> <span class="st">"ImageNb"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># Use shiny with SCE object and masks</span></span></span>
<span class="r-in"><span>   <span class="fu">cytomapperShiny</span><span class="op">(</span>object <span class="op">=</span> <span class="va">pancreasSCE</span>, mask <span class="op">=</span> <span class="va">pancreasMasks</span>,</span></span>
<span class="r-in"><span>                 cell_id <span class="op">=</span> <span class="st">"CellNb"</span>, img_id <span class="op">=</span> <span class="st">"ImageNb"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co"># Use shiny with SCE object only</span></span></span>
<span class="r-in"><span>   <span class="fu">cytomapperShiny</span><span class="op">(</span>object <span class="op">=</span> <span class="va">pancreasSCE</span>,</span></span>
<span class="r-in"><span>                 cell_id <span class="op">=</span> <span class="st">"CellNb"</span>, img_id <span class="op">=</span> <span class="st">"ImageNb"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nils Eling, Nicolas Damond, Lasse Meyer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

