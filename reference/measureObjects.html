<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute morphological and intensity features from objects on images. — measureObjects • cytomapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute morphological and intensity features from objects on images. — measureObjects" />
<meta property="og:description" content="For each object (e.g. cell) identified by segmentation, the
measureObjects function computes intensity features (also referred to
as basic features; e.g. mean intensity), shape features (e.g. area), moment
features (e.g. position) and haralick features. These features are returned
in form of a SingleCellExperiment object." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cytomapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cytomapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cytomapper_ondisk.html">On disk storage and handling of images</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BodenmillerGroup/cytomapper/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute morphological and intensity features from objects on images.</h1>
    <small class="dont-index">Source: <a href='https://github.com/BodenmillerGroup/cytomapper/blob/master/R/measureObjects.R'><code>R/measureObjects.R</code></a></small>
    <div class="hidden name"><code>measureObjects.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For each object (e.g. cell) identified by segmentation, the
<code>measureObjects</code> function computes intensity features (also referred to
as basic features; e.g. mean intensity), shape features (e.g. area), moment
features (e.g. position) and haralick features. These features are returned
in form of a SingleCellExperiment object.</p>
    </div>

    <pre class="usage"><span class='fu'>measureObjects</span><span class='op'>(</span>
  <span class='va'>mask</span>,
  <span class='va'>image</span>,
  <span class='va'>img_id</span>,
  feature_types <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"basic"</span>, <span class='st'>"shape"</span>, <span class='st'>"moment"</span><span class='op'>)</span>,
  basic_feature <span class='op'>=</span> <span class='st'>"mean"</span>,
  basic_quantiles <span class='op'>=</span> <span class='cn'>NULL</span>,
  shape_feature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"area"</span>, <span class='st'>"radius.mean"</span><span class='op'>)</span>,
  moment_feature <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cx"</span>, <span class='st'>"cy"</span>, <span class='st'>"majoraxis"</span>, <span class='st'>"eccentricity"</span><span class='op'>)</span>,
  haralick_feature <span class='op'>=</span> <span class='cn'>NULL</span>,
  haralick_nbins <span class='op'>=</span> <span class='fl'>32</span>,
  haralick_scales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>SerialParam</span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mask</th>
      <td><p>a <code><a href='CytoImageList-class.html'>CytoImageList</a></code> object containing single-channel
<code>Image</code> or <code>HDF5Array</code> objects.
Segmentation masks must contain integer pixel values where groups of
pixels correspond to objects.</p></td>
    </tr>
    <tr>
      <th>image</th>
      <td><p>a <code><a href='CytoImageList-class.html'>CytoImageList</a></code> object containing single or
multi-channel <code>Image</code> or <code>HDF5Array</code>
objects, where each channel indicates the measured pixel intensities.</p></td>
    </tr>
    <tr>
      <th>img_id</th>
      <td><p>character specifying the <code>mcols(image)</code> and
<code>mcols(mask)</code> entry, in which the image IDs are stored.</p></td>
    </tr>
    <tr>
      <th>feature_types</th>
      <td><p>character vector or string indicating which features to
compute. Needs to contain <code>"basic"</code>. Optionally, <code>"shape"</code>,
<code>"moment"</code> and <code>"haralick"</code> are allowed. Default <code>"basic"</code>,
<code>"shape"</code> and <code>"moment"</code>.</p></td>
    </tr>
    <tr>
      <th>basic_feature</th>
      <td><p>string indicating which intensity measurement per object
and channel should be used to populate the <code>counts(x)</code> slot; where
<code>x</code> is the returned <code>SingleCellExperiment</code> object. Default
<code>"mean"</code> but <code>"sd"</code>, <code>"mad"</code> and <code>"q*"</code> allowed. Here,
<code><a href='https://rdrr.io/r/base/Arithmetic.html'>*</a></code> indicates the computed quantile (see <code>basic_quantiles</code>).</p></td>
    </tr>
    <tr>
      <th>basic_quantiles</th>
      <td><p>numeric vector or single number indicating which
quantiles to compute. Default none.</p></td>
    </tr>
    <tr>
      <th>shape_feature</th>
      <td><p>string or character vector specifying which shape
features to compute. Default <code>"area"</code> and <code>"radius.mean"</code>.
Allowed entries are: <code>"area"</code>, <code>"perimeter"</code>,
<code>"radius.mean"</code>, <code>"radius.sd"</code>, <code>"radius.max"</code>,
<code>"radius.min"</code>.</p></td>
    </tr>
    <tr>
      <th>moment_feature</th>
      <td><p>string or character vector indicating which moment
features to compute. Default <code>"cx"</code>, <code>"cy"</code>, <code>"majoraxis"</code>,
and <code>"eccentricity"</code>. Other allowed features are <code>"theta"</code>. Here
moment features are only computed on the segmentation mask without
incorporating pixel intensities. Therefore, <code>"cx"</code> and <code>"cy"</code> are
the x and y coordinates of the cell centroids.</p></td>
    </tr>
    <tr>
      <th>haralick_feature</th>
      <td><p>string or character vector indicating which haralick
features to compute. Default none. Allowed are the 13 haralick features:
<code>"asm"</code>, <code>"con"</code>, <code>"cor"</code>, <code>"var"</code>, <code>"idm"</code>,
<code>"sav"</code>, <code>"sva"</code>, <code>"sen"</code>, <code>"ent"</code>, <code>"dva"</code>,
<code>"den"</code>, <code>"f12"</code>, <code>"f13"</code></p></td>
    </tr>
    <tr>
      <th>haralick_nbins</th>
      <td><p>an integer indicating the number of bins used to
compute the haralick matrix. Pixel intensities are binned in
<code>haralick_nbins</code> discrete gray levels before computing the haralick
matrix.</p></td>
    </tr>
    <tr>
      <th>haralick_scales</th>
      <td><p>an integer vector indicating the number of scales
(distance at which to consider neighbouring pixels) to use to compute the
haralick features.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>parameters for parallelised processing of images.
See <code>MulticoreParam</code> for information on how to use multiple
cores for parallelised processing.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A SingleCellExperiment object (see details)</p>
    <h2 class="hasAnchor" id="the-returned-singlecellexperiment-objects"><a class="anchor" href="#the-returned-singlecellexperiment-objects"></a>The returned SingleCellExperiment objects</h2>

    

<p>The returned SingleCellExperiment object <code>sce</code> contains a single assay.
This assay contains individual objects in columns and channels in rows. Each
entry summarises the intensities per object and channel. This summary
statistic is typically the mean intensity per object and channel. However,
other summary statistics can be computed. When the mean intensity per object
and channel is computed (default), the assay is accessible via
<code>counts(sce)</code>. Otherwise, the assay needs to be accessed via
<code>assay(sce, "counts_*")</code>, where <code><a href='https://rdrr.io/r/base/Arithmetic.html'>*</a></code> indicates the argument to
<code>basic_feature</code>.</p>
<p>The <code>colData(x)</code> entry is populated by the computed shape, moment and
haralick features per object. The prefix of the feature names indicate
whether these features correspond to shape (<code>s.</code>), moment (<code>m.</code>) or
haralick (<code>h.</code>) features. Default features are the following:</p>
<ul>
<li><p>s.areaobject size in pixels</p></li>
<li><p>s.radius.meanmean object radius in pixels</p></li>
<li><p>m.cxx centroid position of object</p></li>
<li><p>m.cyy centroid position of object</p></li>
<li><p>m.majoraxismajor axis length in pixels of elliptical fit</p></li>
<li><p>m.eccentricityelliptical eccentricity. 1 meaning straight line and 0
meaning circle.</p></li>
</ul>

    <h2 class="hasAnchor" id="computing-quantiles"><a class="anchor" href="#computing-quantiles"></a>Computing quantiles</h2>

    

<p>Sometimes it can be useful to describe the summarised pixel intensity per
object and channel not in terms of the mean but some quantile of the pixel
distribution. For example, to compute the median pixel intensity per object
and channel, set <code>basic_feature = "q05"</code> and <code>basic_quantiles =
0.5</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>computeFeatures</code>, for detailed explanation for the computed features.
<a href='https://earlglynn.github.io/RNotes/package/EBImage/Haralick-Textural-Features.html'>https://earlglynn.github.io/RNotes/package/EBImage/Haralick-Textural-Features.html</a>
for more discussion on the haralick features</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Nils Eling (<a href='mailto:nils.eling@dqbm.uzh.ch'>nils.eling@dqbm.uzh.ch</a>),</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Standard example</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pancreasImages</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pancreasMasks</span><span class='op'>)</span>

<span class='va'>sce</span> <span class='op'>&lt;-</span> <span class='fu'>measureObjects</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, <span class='va'>pancreasImages</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span><span class='op'>)</span>
<span class='va'>sce</span>
</div><div class='output co'>#&gt; class: SingleCellExperiment 
#&gt; dim: 5 362 
#&gt; metadata(0):
#&gt; assays(1): counts
#&gt; rownames(5): H3 CD99 PIN CD8a CDH
#&gt; rowData names(0):
#&gt; colnames: NULL
#&gt; colData names(8): ImageNb object_id ... m.majoraxis m.eccentricity
#&gt; reducedDimNames(0):
#&gt; altExpNames(0):</div><div class='input'>
<span class='co'># Compute only intensity feature</span>
<span class='va'>sce</span> <span class='op'>&lt;-</span> <span class='fu'>measureObjects</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, <span class='va'>pancreasImages</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
                        feature_types <span class='op'>=</span> <span class='st'>"basic"</span><span class='op'>)</span>
<span class='fu'>colData</span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 362 rows and 2 columns
#&gt;       ImageNb object_id
#&gt;     &lt;integer&gt; &lt;numeric&gt;
#&gt; 1           1       824
#&gt; 2           1       835
#&gt; 3           1       839
#&gt; 4           1       844
#&gt; 5           1       847
#&gt; ...       ...       ...
#&gt; 358         3      4165
#&gt; 359         3      4167
#&gt; 360         3      4173
#&gt; 361         3      4190
#&gt; 362         3      4209</div><div class='input'>
<span class='co'># Visualize on segmentation masks</span>
<span class='fu'><a href='plotCells.html'>plotCells</a></span><span class='op'>(</span><span class='va'>pancreasMasks</span>, object <span class='op'>=</span> <span class='va'>sce</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"object_id"</span>, colour_by <span class='op'>=</span> <span class='st'>"PIN"</span><span class='op'>)</span>
</div><div class='img'><img src='measureObjects-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nils Eling, Nicolas Damond.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


