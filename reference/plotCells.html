<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Function to visualize cell-level information on segmentation masks — plotCells • cytomapper</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Function to visualize cell-level information on segmentation masks — plotCells" />
<meta property="og:description" content="This function takes a SingleCellExperiment and
CytoImageList object containing segmentation masks to
colour cells by marker expression or metadata." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cytomapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cytomapper.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cytomapper_ondisk.html">On disk storage and handling of images</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BodenmillerGroup/cytomapper/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to visualize cell-level information on segmentation masks</h1>
    <small class="dont-index">Source: <a href='https://github.com/BodenmillerGroup/cytomapper/blob/master/R/plotCells.R'><code>R/plotCells.R</code></a></small>
    <div class="hidden name"><code>plotCells.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes a <code>SingleCellExperiment</code> and
<code><a href='CytoImageList-class.html'>CytoImageList</a></code> object containing segmentation masks to
colour cells by marker expression or metadata.</p>
    </div>

    <pre class="usage"><span class='fu'>plotCells</span><span class='op'>(</span>
  <span class='va'>mask</span>,
  object <span class='op'>=</span> <span class='cn'>NULL</span>,
  cell_id <span class='op'>=</span> <span class='cn'>NULL</span>,
  img_id <span class='op'>=</span> <span class='cn'>NULL</span>,
  colour_by <span class='op'>=</span> <span class='cn'>NULL</span>,
  outline_by <span class='op'>=</span> <span class='cn'>NULL</span>,
  exprs_values <span class='op'>=</span> <span class='st'>"counts"</span>,
  colour <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mask</th>
      <td><p>a <code><a href='CytoImageList-class.html'>CytoImageList</a></code> containing single-channel
<code>Image</code> objects (see section 'Segmentation mask object'
below).</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>a <code>SingleCellExperiment</code> object.</p></td>
    </tr>
    <tr>
      <th>cell_id</th>
      <td><p>character specifying the <code>colData(object)</code> entry, in
which the integer cell IDs are stored. These IDs should match the integer
pixel values in the segmentation mask object.</p></td>
    </tr>
    <tr>
      <th>img_id</th>
      <td><p>character specifying the <code>colData(object)</code> and
<code>mcols(mask)</code> entry, in which the image IDs are stored (see section
'Linking the <code>SingleCellExperiment</code> and <code>CytoImageList</code> object'
below)</p></td>
    </tr>
    <tr>
      <th>colour_by</th>
      <td><p>character or character vector specifying the features
(<code><a href='https://rdrr.io/r/base/colnames.html'>rownames(object)</a></code>) or metadata (<code>colData(object)</code> entry) used
to colour individual cells. Cells can be coloured by single
<code>colData(object)</code> entries or by up to six features.</p></td>
    </tr>
    <tr>
      <th>outline_by</th>
      <td><p>single character indicating the <code>colData(object)</code>
entry by which to outline individual cells.</p></td>
    </tr>
    <tr>
      <th>exprs_values</th>
      <td><p>single character indicating which <code>assay(object)</code>
entry to use when visualizing feature counts.</p></td>
    </tr>
    <tr>
      <th>colour</th>
      <td><p>a list with names matching the entries to <code>colour_by</code>
and/or <code>outline_by</code>. When setting the colour for continous features,
at least two colours need to be provided indicating the colours for minimum
and maximum values. When colouring discrete vectors, a colour for each
unique entry needs to be provided (see section 'Setting the colours' and
examples)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to <code>?"<a href='plotting-param.html'>plotting-param</a>"</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list if <code>return_images</code> and/or <code>return_plot</code> is TRUE
(see <code>?"<a href='plotting-param.html'>plotting-param</a>"</code>).</p><ul>
<li><p><code>plot</code>: a single plot object (<code>display = "all"</code>) or a list
of plot objects (<code>display = "single"</code>)</p></li>
<li><p><code>images</code>: a <code>SimpleList</code> object containing
three-colour <code>Image</code> objects.</p></li>
</ul>

    <h2 class="hasAnchor" id="segmentation-mask-object"><a class="anchor" href="#segmentation-mask-object"></a>Segmentation mask object</h2>

    

<p>In the <code>plotCells</code> function, <code>mask</code> refers to a
<code><a href='CytoImageList-class.html'>CytoImageList</a></code> object that contains a single or multiple
segmentation masks in form of individual <code>Image</code> objects.
The function assumes that each object in the segmentation mask is a cell.
The key features of such masks include:</p><ul>
<li><p>each Image object contains only one channel</p></li>
<li><p>pixel values are integers indicating the cells' IDs or 
    0 (background)</p></li>
</ul>

    <h2 class="hasAnchor" id="linking-singlecellexperiment-and-cytoimagelist-objects"><a class="anchor" href="#linking-singlecellexperiment-and-cytoimagelist-objects"></a>Linking SingleCellExperiment and CytoImageList objects</h2>

    

<p>To colour individual cells contained in the segmentation masks based on
features and metadata stored in the SingleCellExperiment object, an
<code>img_id</code> and <code>cell_id</code> entry needs to be provided. Image IDs are
matched between the <code>SingleCellExperiment</code> and <code>CytoImageList</code>
object via entries to the <code>colData(object)[,img_id]</code> and the
<code>mcols(mask)[,img_id]</code> slots. Cell IDs are matched between the
<code>SingleCellExperiment</code> and <code>CytoImageList</code> object via entries to
<code>colData(object)[,cell_id]</code> and the integer values of the segmentation
masks.</p>
    <h2 class="hasAnchor" id="setting-the-colours"><a class="anchor" href="#setting-the-colours"></a>Setting the colours</h2>

    

<p>By default, features and metadata are coloured based on internally-set
colours. To set new colours, a <code>list</code> object must be provided. The names
of the object must correspond to the entries to <code>colour_by</code> and/or
<code>outline_by</code>. When setting the colours for continous expression values
or continous metadata entries, a vector of at least two colours need to be
specified. These colours will be passed onto <code><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></code>
for interpolation. Discrete metadata entries can be coloured by specifying a
named vector in which each entry corresponds to a unique entry to the
metadata vector.</p>
    <h2 class="hasAnchor" id="subsetting-the-cytoimagelist-object"><a class="anchor" href="#subsetting-the-cytoimagelist-object"></a>Subsetting the <code>CytoImageList</code> object</h2>

    

<p>The <code>CytoImageList</code> object can be subsetted before calling the
<code>plotCells</code> function. In that case, only the selected images are
displayed.</p>
    <h2 class="hasAnchor" id="subsetting-the-singlecellexperiment-object"><a class="anchor" href="#subsetting-the-singlecellexperiment-object"></a>Subsetting the <code>SingleCellExperiment</code> object</h2>

    

<p>The <code>SingleCellExperiment</code> object can be subsetted before calling the
<code>plotCells</code> function. In that case, only cells contained in the
<code>SingleCellExperiment</code> object are coloured/outlined.</p>
    <h2 class="hasAnchor" id="colour-scaling"><a class="anchor" href="#colour-scaling"></a>Colour scaling</h2>

    

<p>When colouring features using the plotCells function, colours are scaled
between the minimum and maximum per feature across the full assay contained
in the SingleCellExperiment object. When subsetting images, cell-level
expression is not scaled across the subsetted images but the whole
SingleCellExperiment object. To avoid this, the SingleCellExperiment object
can be subsetted to only contain the cells that should be displayed before
plotting.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For further plotting parameters see <code>?"<a href='plotting-param.html'>plotting-param</a>"</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Nils Eling (<a href='mailto:nils.eling@dqbm.uzh.ch'>nils.eling@dqbm.uzh.ch</a>)</p>
<p>Nicolas Damond (<a href='mailto:nicolas.damond@dqbm.uzh.ch'>nicolas.damond@dqbm.uzh.ch</a>)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pancreasMasks</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pancreasSCE</span><span class='op'>)</span>

<span class='co'># Visualize the masks</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>pancreasMasks</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Colour the masks based on averaged expression</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, object <span class='op'>=</span> <span class='va'>pancreasSCE</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"CellNb"</span>, colour_by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CD99"</span>, <span class='st'>"CDH"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Colour the masks based on metadata</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, object <span class='op'>=</span> <span class='va'>pancreasSCE</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"CellNb"</span>, colour_by <span class='op'>=</span> <span class='st'>"CellType"</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Outline the masks based on metadata</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, object <span class='op'>=</span> <span class='va'>pancreasSCE</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"CellNb"</span>, colour_by <span class='op'>=</span> <span class='st'>"CD99"</span>,
            outline_by <span class='op'>=</span> <span class='st'>"CellType"</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Colour the masks based on arcsinh-transformed expression</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, object <span class='op'>=</span> <span class='va'>pancreasSCE</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"CellNb"</span>, colour_by <span class='op'>=</span> <span class='st'>"CD99"</span>,
            exprs_values <span class='op'>=</span> <span class='st'>"exprs"</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Subset the images</span>
<span class='va'>cur_images</span> <span class='op'>&lt;-</span> <span class='fu'><a href='CytoImageList-subsetting.html'>getImages</a></span><span class='op'>(</span><span class='va'>pancreasMasks</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>cur_images</span>, object <span class='op'>=</span> <span class='va'>pancreasSCE</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"CellNb"</span>, colour_by <span class='op'>=</span> <span class='st'>"CD99"</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Set colour</span>
<span class='fu'>plotCells</span><span class='op'>(</span><span class='va'>pancreasMasks</span>, object <span class='op'>=</span> <span class='va'>pancreasSCE</span>, img_id <span class='op'>=</span> <span class='st'>"ImageNb"</span>,
            cell_id <span class='op'>=</span> <span class='st'>"CellNb"</span>, colour_by <span class='op'>=</span> <span class='st'>"CD99"</span>, outline_by <span class='op'>=</span> <span class='st'>"CellType"</span>,
            colour <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>CD99 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"black"</span>, <span class='st'>"red"</span><span class='op'>)</span>,
                            CellType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>celltype_A <span class='op'>=</span> <span class='st'>"blue"</span>,
                                        celltype_B <span class='op'>=</span> <span class='st'>"green"</span>,
                                        celltype_C <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='plotCells-7.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nils Eling, Nicolas Damond.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


